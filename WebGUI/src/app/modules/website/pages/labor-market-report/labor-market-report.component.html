<!-- Splash Screen -->
<app-splash-screen></app-splash-screen>

<div class="container">
  <div class="dashboard-layout">
    <app-dashboard-sidebar></app-dashboard-sidebar>

    <div class="dashboard-content-wrap">
      
      <!-- Page Header -->
      <div class="page-header">
        <div class="header-content">
          <div class="header-text">
            <h1 class="page-title">B√°o c√°o th·ªã tr∆∞·ªùng lao ƒë·ªông</h1>
            <p class="page-subtitle">Th√¥ng tin v·ªÅ xu h∆∞·ªõng tuy·ªÉn d·ª•ng v√† ng√†nh ngh·ªÅ c√≥ nhu c·∫ßu cao</p>
          </div>
          <div class="header-actions">
            <button (click)="refreshMarketData()" class="btn-action refresh" title="L√†m m·ªõi d·ªØ li·ªáu">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M23 4v6h-6" stroke="currentColor" stroke-width="2"/>
                <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10" stroke="currentColor" stroke-width="2"/>
              </svg>
              L√†m m·ªõi
            </button>
            <div class="export-dropdown">
              <button class="btn-action primary dropdown-toggle">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="currentColor" stroke-width="2"/>
                  <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2"/>
                  <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2"/>
                </svg>
                Xu·∫•t b√°o c√°o
              </button>
              <div class="dropdown-menu">
                <button (click)="exportMarketReport('pdf')" class="dropdown-item">PDF</button>
                <button (click)="exportMarketReport('excel')" class="dropdown-item">Excel</button>
                <button (click)="exportMarketReport('csv')" class="dropdown-item">CSV</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Filters Section -->
      <div class="filters-section">
        <div class="filter-grid">
          <div class="filter-item">
            <label>Kho·∫£ng th·ªùi gian:</label>
            <select [(ngModel)]="selectedTimeRange" (change)="onTimeRangeChange(selectedTimeRange)" class="filter-select">
              <option value="monthly">H√†ng th√°ng</option>
              <option value="quarterly">H√†ng qu√Ω</option>
              <option value="yearly">H√†ng nƒÉm</option>
            </select>
          </div>
          <div class="filter-item">
            <label>Ng√†nh ngh·ªÅ:</label>
            <select [(ngModel)]="selectedIndustry" (change)="onIndustryChange(selectedIndustry)" class="filter-select">
              <option value="all">T·∫•t c·∫£ ng√†nh</option>
              <option value="it">C√¥ng ngh·ªá th√¥ng tin</option>
              <option value="ecommerce">Th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠</option>
              <option value="finance">T√†i ch√≠nh ng√¢n h√†ng</option>
              <option value="manufacturing">S·∫£n xu·∫•t ch·∫ø bi·∫øn</option>
              <option value="tourism">Du l·ªãch kh√°ch s·∫°n</option>
              <option value="education">Gi√°o d·ª•c ƒë√†o t·∫°o</option>
            </select>
          </div>
          <div class="filter-item">
            <label>Khu v·ª±c:</label>
            <select [(ngModel)]="selectedRegion" (change)="onRegionChange(selectedRegion)" class="filter-select">
              <option value="laocai">L√†o Cai</option>
              <option value="hanoi">H√† N·ªôi</option>
              <option value="hcm">TP.HCM</option>
              <option value="danang">ƒê√† N·∫µng</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Market Overview -->
      <div class="market-overview">
        <div class="overview-grid">
          <div class="overview-card jobs">
            <div class="card-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                <line x1="8" y1="21" x2="16" y2="21" stroke="currentColor" stroke-width="2"/>
                <line x1="12" y1="17" x2="12" y2="21" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="card-content">
              <div class="card-number">{{marketOverview.totalActiveJobs | number}}</div>
              <div class="card-label">Vi·ªác l√†m ƒëang tuy·ªÉn</div>
              <div class="card-trend positive">+{{marketOverview.jobGrowthRate}}% tƒÉng tr∆∞∆°ng</div>
            </div>
          </div>

          <div class="overview-card companies">
            <div class="card-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2"/>
                <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="card-content">
              <div class="card-number">{{marketOverview.totalCompaniesHiring | number}}</div>
              <div class="card-label">C√¥ng ty ƒëang tuy·ªÉn</div>
              <div class="card-trend positive">TƒÉng m·∫°nh trong Q1</div>
            </div>
          </div>

          <div class="overview-card time">
            <div class="card-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="card-content">
              <div class="card-number">{{marketOverview.avgTimeToHire}}</div>
              <div class="card-label">Ng√†y tuy·ªÉn d·ª•ng TB</div>
              <div class="card-trend positive">Gi·∫£m 3 ng√†y so v·ªõi tr∆∞·ªõc</div>
            </div>
          </div>

          <div class="overview-card salary">
            <div class="card-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <line x1="12" y1="1" x2="12" y2="23" stroke="currentColor" stroke-width="2"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="card-content">
              <div class="card-number">+{{marketOverview.salaryGrowth}}%</div>
              <div class="card-label">TƒÉng tr∆∞·ªüng l∆∞∆°ng</div>
              <div class="card-trend positive">So v·ªõi c√πng k·ª≥ nƒÉm tr∆∞·ªõc</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Job Trends by Industry -->
      <div class="industry-trends-section">
        <div class="section-header">
          <h3 class="section-title">Xu h∆∞·ªõng tuy·ªÉn d·ª•ng theo ng√†nh</h3>
          <div class="section-subtitle">Nhu c·∫ßu tuy·ªÉn d·ª•ng v√† m·ª©c l∆∞∆°ng trung b√¨nh</div>
        </div>
        <div class="industry-trends-grid">
          <div *ngFor="let trend of jobTrends" class="industry-trend-card">
            <div class="trend-header">
              <div class="trend-info">
                <h4 class="industry-name">{{trend.industry}}</h4>
                <div [class]="'demand-level ' + getDemandLevelClass(trend.demandLevel)">
                  {{getDemandLevelText(trend.demandLevel)}}
                </div>
              </div>
              <div class="trend-growth" [style.color]="trend.color">
                +{{trend.growth}}%
              </div>
            </div>
            <div class="trend-content">
              <div class="salary-info">
                <div class="salary-label">M·ª©c l∆∞∆°ng trung b√¨nh:</div>
                <div class="salary-range">{{trend.avgSalary}}</div>
              </div>
              <div class="top-positions">
                <div class="positions-label">V·ªã tr√≠ hot:</div>
                <div class="positions-list">
                  <span *ngFor="let position of trend.topPositions; let last = last" class="position-item">
                    {{position}}<span *ngIf="!last">, </span>
                  </span>
                </div>
              </div>
            </div>
            <div class="trend-indicator" [style.background]="trend.color"></div>
          </div>
        </div>
      </div>

      <!-- Skills in Demand -->
      <div class="skills-section">
        <div class="skills-grid">
          
          <!-- Top Skills Chart -->
          <div class="skills-chart-card">
            <div class="card-header">
              <h3 class="card-title">K·ªπ nƒÉng ƒë∆∞·ª£c t√¨m ki·∫øm nhi·ªÅu nh·∫•t</h3>
              <div class="card-subtitle">Top 10 k·ªπ nƒÉng c√≥ nhu c·∫ßu cao</div>
            </div>
            <div class="card-content">
              <div class="skills-chart">
                <div *ngFor="let skill of skillDemands" class="skill-bar">
                  <div class="skill-info">
                    <div class="skill-name">{{skill.skill}}</div>
                    <div class="skill-category">{{skill.category}}</div>
                  </div>
                  <div class="skill-metrics">
                    <div class="skill-demand">{{skill.demand}} v·ªã tr√≠</div>
                    <div [class]="'skill-growth ' + getSkillLevelClass(skill.level)">
                      +{{skill.growth}}%
                    </div>
                  </div>
                  <div class="skill-bar-container">
                    <div class="skill-bar-fill" 
                         [style.width.%]="(skill.demand / skillDemands[0].demand) * 100"
                         [class]="getSkillLevelClass(skill.level)">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Hot Skills -->
          <div class="hot-skills-card">
            <div class="card-header">
              <h3 class="card-title">K·ªπ nƒÉng "hot" nh·∫•t</h3>
              <div class="card-subtitle">ƒêang c√≥ xu h∆∞·ªõng tƒÉng m·∫°nh</div>
            </div>
            <div class="card-content">
              <div class="hot-skills-list">
                <div *ngFor="let skill of getHotSkills()" class="hot-skill-item">
                  <div class="hot-skill-info">
                    <div class="hot-skill-name">{{skill.skill}}</div>
                    <div class="hot-skill-category">{{skill.category}}</div>
                  </div>
                  <div class="hot-skill-badge">
                    <span class="hot-icon">üî•</span>
                    <span class="hot-growth">+{{skill.growth}}%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- Salary Ranges -->
      <div class="salary-section">
        <div class="section-header">
          <h3 class="section-title">M·ª©c l∆∞∆°ng theo v·ªã tr√≠</h3>
          <div class="section-subtitle">Kh·∫£o s√°t m·ª©c l∆∞∆°ng trung b√¨nh tr√™n th·ªã tr∆∞·ªùng</div>
        </div>
        <div class="salary-table">
          <div class="salary-header">
            <div class="col-position">V·ªã tr√≠</div>
            <div class="col-experience">Kinh nghi·ªám</div>
            <div class="col-salary">M·ª©c l∆∞∆°ng (tri·ªáu VNƒê)</div>
            <div class="col-count">S·ªë l∆∞·ª£ng</div>
          </div>
          <div class="salary-body">
            <div *ngFor="let range of salaryRanges" class="salary-row">
              <div class="col-position">
                <div class="position-name">{{range.position}}</div>
              </div>
              <div class="col-experience">
                <div class="experience-badge">{{range.experience}}</div>
              </div>
              <div class="col-salary">
                <div class="salary-range-display">
                  <div class="salary-bar-wrapper">
                    <div class="salary-bar-track">
                      <div class="salary-bar-range" 
                           [style.left.%]="getSalaryBarWidth(range.minSalary)"
                           [style.width.%]="getSalaryBarWidth(range.maxSalary - range.minSalary)">
                      </div>
                      <div class="salary-bar-avg" 
                           [style.left.%]="getSalaryBarWidth(range.avgSalary)">
                      </div>
                    </div>
                    <div class="salary-text">
                      {{range.minSalary}} - {{range.maxSalary}} (TB: {{range.avgSalary}})
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-count">
                <div class="count-badge">{{range.count}} VT</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Market Insights -->
      <div class="insights-section">
        <div class="section-header">
          <h3 class="section-title">Th√¥ng tin th·ªã tr∆∞·ªùng</h3>
          <div class="section-subtitle">Xu h∆∞·ªõng v√† ph√¢n t√≠ch th·ªã tr∆∞·ªùng lao ƒë·ªông</div>
        </div>
        <div class="insights-grid">
          <div *ngFor="let insight of marketInsights" 
               [class]="'insight-card ' + getInsightClass(insight.impact)">
            <div class="insight-header">
              <div class="insight-icon">{{getInsightIcon(insight.impact)}}</div>
              <div class="insight-meta">
                <div class="insight-category">{{insight.category}}</div>
                <div class="insight-date">{{insight.date | date:'dd/MM/yyyy'}}</div>
              </div>
            </div>
            <div class="insight-content">
              <h4 class="insight-title">{{insight.title}}</h4>
              <p class="insight-description">{{insight.description}}</p>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>



